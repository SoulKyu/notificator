// Code generated by templ - DO NOT EDIT.

// templ: version: v0.3.906
package pages

//lint:file-ignore SA4006 This context is only used if a nested component is present.

import "github.com/a-h/templ"
import templruntime "github.com/a-h/templ/runtime"

import (
	"notificator/internal/webui/templates/layouts"
)

type StatisticsDashboardData struct {
	User ProfileUser
}

func StatisticsDashboard(data StatisticsDashboardData) templ.Component {
	return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
		templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
		if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil {
			return templ_7745c5c3_CtxErr
		}
		templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
		if !templ_7745c5c3_IsBuffer {
			defer func() {
				templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err == nil {
					templ_7745c5c3_Err = templ_7745c5c3_BufErr
				}
			}()
		}
		ctx = templ.InitializeContext(ctx)
		templ_7745c5c3_Var1 := templ.GetChildren(ctx)
		if templ_7745c5c3_Var1 == nil {
			templ_7745c5c3_Var1 = templ.NopComponent
		}
		ctx = templ.ClearChildren(ctx)
		templ_7745c5c3_Err = layouts.Base("Alert Statistics - Notificator", StatisticsDashboardContent(data)).Render(ctx, templ_7745c5c3_Buffer)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		return nil
	})
}

func StatisticsDashboardContent(data StatisticsDashboardData) templ.Component {
	return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
		templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
		if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil {
			return templ_7745c5c3_CtxErr
		}
		templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
		if !templ_7745c5c3_IsBuffer {
			defer func() {
				templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err == nil {
					templ_7745c5c3_Err = templ_7745c5c3_BufErr
				}
			}()
		}
		ctx = templ.InitializeContext(ctx)
		templ_7745c5c3_Var2 := templ.GetChildren(ctx)
		if templ_7745c5c3_Var2 == nil {
			templ_7745c5c3_Var2 = templ.NopComponent
		}
		ctx = templ.ClearChildren(ctx)
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 1, "<div class=\"min-h-screen bg-gray-50 dark:bg-dark-bg-primary py-8\" x-data=\"statisticsDashboardPage()\"><div class=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\"><!-- Header --><div class=\"mb-8\"><nav class=\"flex\" aria-label=\"Breadcrumb\"><ol class=\"flex items-center space-x-4\"><li><a href=\"/dashboard\" class=\"text-gray-400 hover:text-gray-500 dark:text-gray-500 dark:hover:text-gray-400\"><svg class=\"flex-shrink-0 h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\"><path d=\"M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z\"></path></svg> <span class=\"sr-only\">Dashboard</span></a></li><li><div class=\"flex items-center\"><svg class=\"flex-shrink-0 h-5 w-5 text-gray-400\" viewBox=\"0 0 20 20\" fill=\"currentColor\"><path fill-rule=\"evenodd\" d=\"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z\" clip-rule=\"evenodd\"></path></svg> <span class=\"ml-4 text-sm font-medium text-gray-500 dark:text-gray-400\">Statistics</span></div></li></ol></nav><div class=\"mt-4 flex items-center justify-between\"><div><h1 class=\"text-3xl font-bold text-gray-900 dark:text-white\">Alert Statistics</h1><p class=\"mt-1 text-sm text-gray-500 dark:text-gray-400\">View and analyze alert metrics over time</p></div><div class=\"flex space-x-3\"><a href=\"/statistics/rules\" class=\"inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 shadow-sm text-sm font-medium rounded-md text-gray-700 dark:text-gray-200 bg-white dark:bg-dark-bg-tertiary hover:bg-gray-50 dark:hover:bg-dark-bg-secondary focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors\"><svg class=\"mr-2 h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4\"></path></svg> Manage Rules</a> <button @click=\"exportData\" :disabled=\"loading || !hasData\" class=\"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"><svg class=\"mr-2 h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\"></path></svg> Export CSV</button></div></div></div><!-- Filters Panel --><div class=\"mb-6 bg-white dark:bg-dark-bg-secondary rounded-lg shadow-sm border border-gray-200 dark:border-dark-border-subtle p-6\"><div class=\"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-4 gap-4\"><!-- Date Range Selector --><div class=\"xl:col-span-2\"><label class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">Time Range</label><div class=\"flex space-x-2\"><div class=\"flex-1\"><input type=\"date\" x-model=\"filters.startDate\" class=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-dark-bg-tertiary dark:text-white text-sm\"></div><span class=\"flex items-center text-gray-500 dark:text-gray-400\">to</span><div class=\"flex-1\"><input type=\"date\" x-model=\"filters.endDate\" class=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-dark-bg-tertiary dark:text-white text-sm\"></div></div><!-- Quick Date Presets --><div class=\"mt-2 flex flex-wrap gap-2\"><button @click=\"setDateRange('today')\" class=\"text-xs px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600\">Today</button> <button @click=\"setDateRange('week')\" class=\"text-xs px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600\">Last 7 Days</button> <button @click=\"setDateRange('month')\" class=\"text-xs px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600\">Last 30 Days</button> <button @click=\"setDateRange('quarter')\" class=\"text-xs px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600\">Last 90 Days</button></div></div><!-- Group By Selector --><div><label class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">Group By</label> <select x-model=\"filters.groupBy\" class=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-dark-bg-tertiary dark:text-white text-sm\"><option value=\"\">Overall</option> <option value=\"severity\">Severity</option> <option value=\"team\">Team</option> <option value=\"alert_name\">Alert Name</option> <option value=\"period\">Time Period</option></select></div><!-- Period Type (shown when groupBy is \"period\") --><div x-show=\"filters.groupBy === 'period'\"><label class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">Period Type</label> <select x-model=\"filters.periodType\" class=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-dark-bg-tertiary dark:text-white text-sm\"><option value=\"hour\">Hourly</option> <option value=\"day\">Daily</option> <option value=\"week\">Weekly</option> <option value=\"month\">Monthly</option></select></div></div><!-- Additional Options Row --><div class=\"mt-4 flex items-center justify-between\"><div class=\"flex items-center space-x-4\"><!-- Apply On-Call Rules Toggle --><label class=\"flex items-center cursor-pointer\"><input type=\"checkbox\" x-model=\"filters.applyRules\" class=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"> <span class=\"ml-2 text-sm text-gray-700 dark:text-gray-300\">Apply On-Call Rules <span class=\"text-xs text-gray-500 dark:text-gray-400\">(filter by your configured rules)</span></span></label><!-- Limit (for alert_name grouping) --><div x-show=\"filters.groupBy === 'alert_name'\" class=\"flex items-center space-x-2\"><label class=\"text-sm text-gray-700 dark:text-gray-300\">Top</label> <input type=\"number\" x-model.number=\"filters.limit\" min=\"5\" max=\"50\" step=\"5\" class=\"w-16 px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-dark-bg-tertiary dark:text-white text-sm\"> <span class=\"text-sm text-gray-700 dark:text-gray-300\">alerts</span></div></div><!-- Query Button --><button @click=\"queryStatistics\" :disabled=\"loading\" class=\"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"><svg x-show=\"loading\" class=\"animate-spin -ml-1 mr-2 h-4 w-4 text-white\" fill=\"none\" viewBox=\"0 0 24 24\"><circle class=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" stroke-width=\"4\"></circle> <path class=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path></svg> <span x-text=\"loading ? 'Loading...' : 'Run Query'\"></span></button></div></div><!-- Loading State --><div x-show=\"loading && !hasData\" class=\"text-center py-12\"><div class=\"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div><p class=\"mt-4 text-gray-500 dark:text-gray-400\">Loading statistics...</p></div><!-- Empty State --><div x-show=\"!loading && !hasData\" class=\"text-center py-12 bg-white dark:bg-dark-bg-secondary rounded-lg shadow-sm border border-gray-200 dark:border-dark-border-subtle\"><svg class=\"mx-auto h-12 w-12 text-gray-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z\"></path></svg><h3 class=\"mt-2 text-sm font-medium text-gray-900 dark:text-white\">No Data</h3><p class=\"mt-1 text-sm text-gray-500 dark:text-gray-400\">Select a time range and click \"Run Query\" to view statistics.</p></div><!-- Statistics Content --><div x-show=\"!loading && hasData\"><!-- Summary Cards --><div class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6\"><!-- Total Alerts Card --><div class=\"bg-white dark:bg-dark-bg-secondary rounded-lg shadow-sm border border-gray-200 dark:border-dark-border-subtle p-6\"><div class=\"flex items-center\"><div class=\"flex-shrink-0 bg-blue-100 dark:bg-blue-900/30 rounded-md p-3\"><svg class=\"h-6 w-6 text-blue-600 dark:text-blue-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9\"></path></svg></div><div class=\"ml-5 w-0 flex-1\"><dt class=\"text-sm font-medium text-gray-500 dark:text-gray-400 truncate\">Total Alerts</dt><dd class=\"flex items-baseline\"><div class=\"text-2xl font-semibold text-gray-900 dark:text-white\" x-text=\"formatNumber(statsData?.total_alerts || 0)\"></div></dd></div></div></div><!-- Average Duration Card --><div class=\"bg-white dark:bg-dark-bg-secondary rounded-lg shadow-sm border border-gray-200 dark:border-dark-border-subtle p-6\"><div class=\"flex items-center\"><div class=\"flex-shrink-0 bg-yellow-100 dark:bg-yellow-900/30 rounded-md p-3\"><svg class=\"h-6 w-6 text-yellow-600 dark:text-yellow-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\"></path></svg></div><div class=\"ml-5 w-0 flex-1\"><dt class=\"text-sm font-medium text-gray-500 dark:text-gray-400 truncate\">Avg Duration</dt><dd class=\"flex items-baseline\"><div class=\"text-2xl font-semibold text-gray-900 dark:text-white\" x-text=\"formatDuration(getOverallAvgDuration())\"></div></dd></div></div></div><!-- Average MTTR Card --><div class=\"bg-white dark:bg-dark-bg-secondary rounded-lg shadow-sm border border-gray-200 dark:border-dark-border-subtle p-6\"><div class=\"flex items-center\"><div class=\"flex-shrink-0 bg-green-100 dark:bg-green-900/30 rounded-md p-3\"><svg class=\"h-6 w-6 text-green-600 dark:text-green-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"></path></svg></div><div class=\"ml-5 w-0 flex-1\"><dt class=\"text-sm font-medium text-gray-500 dark:text-gray-400 truncate\">Avg MTTR</dt><dd class=\"flex items-baseline\"><div class=\"text-2xl font-semibold text-gray-900 dark:text-white\" x-html=\"formatMTTR(getOverallAvgMTTR())\"></div></dd></div></div></div><!-- Time Range Card --><div class=\"bg-white dark:bg-dark-bg-secondary rounded-lg shadow-sm border border-gray-200 dark:border-dark-border-subtle p-6\"><div class=\"flex items-center\"><div class=\"flex-shrink-0 bg-purple-100 dark:bg-purple-900/30 rounded-md p-3\"><svg class=\"h-6 w-6 text-purple-600 dark:text-purple-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z\"></path></svg></div><div class=\"ml-5 w-0 flex-1\"><dt class=\"text-sm font-medium text-gray-500 dark:text-gray-400 truncate\">Time Range</dt><dd class=\"text-sm text-gray-900 dark:text-white\"><div x-text=\"formatDate(statsData?.time_range?.start)\"></div><div class=\"text-xs text-gray-500\" x-text=\"'to ' + formatDate(statsData?.time_range?.end)\"></div></dd></div></div></div></div><!-- Breakdown Tables/Charts --><div class=\"space-y-6\"><!-- Statistics by Group (when not using period grouping) --><div x-show=\"filters.groupBy !== 'period' && Object.keys(statsData?.statistics || {}).length > 0\"><div class=\"bg-white dark:bg-dark-bg-secondary rounded-lg shadow-sm border border-gray-200 dark:border-dark-border-subtle overflow-hidden\"><div class=\"px-6 py-4 border-b border-gray-200 dark:border-dark-border-subtle\"><h3 class=\"text-lg font-medium text-gray-900 dark:text-white\" x-text=\"getGroupByTitle()\"></h3></div><div class=\"overflow-x-auto\"><table class=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\"><thead class=\"bg-gray-50 dark:bg-dark-bg-tertiary\"><tr><th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\"><button @click=\"sortBy('name')\" class=\"flex items-center space-x-1 hover:text-gray-700 dark:hover:text-gray-200 transition-colors\"><span x-text=\"filters.groupBy || 'Category'\"></span> <span x-html=\"getSortIcon('name')\"></span></button></th><th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\"><button @click=\"sortBy('count')\" class=\"flex items-center space-x-1 hover:text-gray-700 dark:hover:text-gray-200 transition-colors\"><span>Count</span> <span x-html=\"getSortIcon('count')\"></span></button></th><th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">Percentage</th><th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\"><button @click=\"sortBy('avg_duration')\" class=\"flex items-center space-x-1 hover:text-gray-700 dark:hover:text-gray-200 transition-colors\"><span>Avg Duration</span> <span x-html=\"getSortIcon('avg_duration')\"></span></button></th><th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\"><button @click=\"sortBy('total_duration')\" class=\"flex items-center space-x-1 hover:text-gray-700 dark:hover:text-gray-200 transition-colors\"><span>Total Duration</span> <span x-html=\"getSortIcon('total_duration')\"></span></button></th><th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\"><button @click=\"sortBy('avg_mttr')\" class=\"flex items-center space-x-1 hover:text-gray-700 dark:hover:text-gray-200 transition-colors\"><span>Avg MTTR</span> <span x-html=\"getSortIcon('avg_mttr')\"></span></button></th></tr></thead> <tbody class=\"bg-white dark:bg-dark-bg-secondary divide-y divide-gray-200 dark:divide-gray-700\"><template x-for=\"[key, stat] in getSortedStatistics()\" :key=\"key\"><tr class=\"hover:bg-gray-50 dark:hover:bg-dark-bg-tertiary\"><td class=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white\"><div class=\"flex items-center\"><span x-text=\"key\" :class=\"getSeverityClass(key)\"></span></div></td><td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400\"><div class=\"flex items-center space-x-2\"><span x-text=\"formatNumber(stat.count)\"></span><div class=\"flex-1 min-w-[100px]\"><div class=\"h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden\"><div class=\"h-full bg-blue-600 dark:bg-blue-500 rounded-full transition-all duration-300\" :style=\"`width: ${(stat.count / getMaxCount() * 100)}%`\"></div></div></div></div></td><td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400\"><span x-text=\"getPercentage(stat.count) + '%'\"></span></td><td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400\" x-text=\"formatDuration(stat.avg_duration_seconds)\"></td><td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400\" x-text=\"formatDuration(stat.total_duration_seconds)\"></td><td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400\" x-html=\"formatMTTR(stat.avg_mttr_seconds)\"></td></tr></template></tbody></table></div></div></div><!-- Period Breakdown (when groupBy is \"period\") --><div x-show=\"filters.groupBy === 'period' && (statsData?.breakdown || []).length > 0\"><div class=\"bg-white dark:bg-dark-bg-secondary rounded-lg shadow-sm border border-gray-200 dark:border-dark-border-subtle overflow-hidden\"><div class=\"px-6 py-4 border-b border-gray-200 dark:border-dark-border-subtle\"><h3 class=\"text-lg font-medium text-gray-900 dark:text-white\">Statistics by Time Period</h3></div><!-- Simple Chart Visualization --><div class=\"p-6\"><div class=\"space-y-4\"><template x-for=\"(item, index) in statsData.breakdown\" :key=\"index\"><div class=\"border-l-4 pl-4 py-2\" :class=\"'border-blue-500'\"><div class=\"flex items-center justify-between mb-2\"><div><div class=\"text-sm font-medium text-gray-900 dark:text-white\" x-text=\"item.period\"></div><div class=\"text-xs text-gray-500 dark:text-gray-400\" x-text=\"formatDate(item.start_time) + ' - ' + formatDate(item.end_time)\"></div></div><div class=\"text-right\"><div class=\"text-lg font-semibold text-gray-900 dark:text-white\" x-text=\"formatNumber(item.total_count)\"></div><div class=\"text-xs text-gray-500 dark:text-gray-400\">alerts</div></div></div><!-- Severity breakdown for this period --><div x-show=\"item.statistics && Object.keys(item.statistics).length > 0\" class=\"mt-2 flex flex-wrap gap-2\"><template x-for=\"(stat, severity) in item.statistics\" :key=\"severity\"><span class=\"inline-flex items-center px-2 py-1 rounded text-xs font-medium\" :class=\"getSeverityBadgeClass(severity)\"><span x-text=\"severity + ': ' + stat.count\"></span></span></template></div></div></template></div></div></div></div></div></div></div></div><script>\n\t\tfunction statisticsDashboardPage() {\n\t\t\treturn {\n\t\t\t\tloading: false,\n\t\t\t\thasData: false,\n\t\t\t\tstatsData: null,\n\t\t\t\tsortColumn: 'count',\n\t\t\t\tsortDirection: 'desc',\n\n\t\t\t\tfilters: {\n\t\t\t\t\tstartDate: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], // Last 7 days\n\t\t\t\t\tendDate: new Date().toISOString().split('T')[0], // Today\n\t\t\t\t\tgroupBy: 'severity',\n\t\t\t\t\tperiodType: 'day',\n\t\t\t\t\tapplyRules: false,\n\t\t\t\t\tlimit: 20\n\t\t\t\t},\n\n\t\t\t\tinit() {\n\t\t\t\t\t// Auto-query on page load\n\t\t\t\t\tthis.queryStatistics();\n\t\t\t\t},\n\n\t\t\t\tasync queryStatistics() {\n\t\t\t\t\tthis.loading = true;\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst payload = {\n\t\t\t\t\t\t\tstart_date: this.filters.startDate + 'T00:00:00Z',\n\t\t\t\t\t\t\tend_date: this.filters.endDate + 'T23:59:59Z',\n\t\t\t\t\t\t\tapply_rules: this.filters.applyRules,\n\t\t\t\t\t\t\tgroup_by: this.filters.groupBy,\n\t\t\t\t\t\t\tperiod_type: this.filters.periodType,\n\t\t\t\t\t\t\tlimit: this.filters.groupBy === 'alert_name' ? this.filters.limit : 0\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tconst response = await fetch('/api/v1/statistics/query', {\n\t\t\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t\t'Content-Type': 'application/json'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tbody: JSON.stringify(payload)\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tif (!response.ok) {\n\t\t\t\t\t\t\tthrow new Error('Failed to query statistics');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst data = await response.json();\n\t\t\t\t\t\tthis.statsData = data.data;\n\t\t\t\t\t\tthis.hasData = true;\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tconsole.error('Error querying statistics:', error);\n\t\t\t\t\t\talert('Failed to load statistics: ' + error.message);\n\t\t\t\t\t\tthis.hasData = false;\n\t\t\t\t\t} finally {\n\t\t\t\t\t\tthis.loading = false;\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\tsetDateRange(preset) {\n\t\t\t\t\tconst now = new Date();\n\t\t\t\t\tconst today = new Date(now.getFullYear(), now.getMonth(), now.getDate());\n\n\t\t\t\t\tswitch(preset) {\n\t\t\t\t\t\tcase 'today':\n\t\t\t\t\t\t\tthis.filters.startDate = today.toISOString().split('T')[0];\n\t\t\t\t\t\t\tthis.filters.endDate = today.toISOString().split('T')[0];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'week':\n\t\t\t\t\t\t\tthis.filters.startDate = new Date(today.getTime() - 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0];\n\t\t\t\t\t\t\tthis.filters.endDate = today.toISOString().split('T')[0];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'month':\n\t\t\t\t\t\t\tthis.filters.startDate = new Date(today.getTime() - 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0];\n\t\t\t\t\t\t\tthis.filters.endDate = today.toISOString().split('T')[0];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'quarter':\n\t\t\t\t\t\t\tthis.filters.startDate = new Date(today.getTime() - 90 * 24 * 60 * 60 * 1000).toISOString().split('T')[0];\n\t\t\t\t\t\t\tthis.filters.endDate = today.toISOString().split('T')[0];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\tgetGroupByTitle() {\n\t\t\t\t\tconst titles = {\n\t\t\t\t\t\t'severity': 'Statistics by Severity',\n\t\t\t\t\t\t'team': 'Statistics by Team',\n\t\t\t\t\t\t'alert_name': 'Statistics by Alert Name',\n\t\t\t\t\t\t'': 'Overall Statistics'\n\t\t\t\t\t};\n\t\t\t\t\treturn titles[this.filters.groupBy] || 'Statistics';\n\t\t\t\t},\n\n\t\t\t\tgetOverallAvgDuration() {\n\t\t\t\t\tif (!this.statsData?.statistics) return 0;\n\t\t\t\t\tconst stats = Object.values(this.statsData.statistics);\n\t\t\t\t\tif (stats.length === 0) return 0;\n\t\t\t\t\tconst total = stats.reduce((sum, s) => sum + (s.avg_duration_seconds || 0), 0);\n\t\t\t\t\treturn total / stats.length;\n\t\t\t\t},\n\n\t\t\t\tgetOverallAvgMTTR() {\n\t\t\t\t\tif (!this.statsData?.statistics) return 0;\n\t\t\t\t\tconst stats = Object.values(this.statsData.statistics);\n\t\t\t\t\tif (stats.length === 0) return 0;\n\t\t\t\t\tconst total = stats.reduce((sum, s) => sum + (s.avg_mttr_seconds || 0), 0);\n\t\t\t\t\treturn total / stats.length;\n\t\t\t\t},\n\n\t\t\t\tgetSeverityClass(severity) {\n\t\t\t\t\tif (this.filters.groupBy !== 'severity') return '';\n\n\t\t\t\t\tconst classes = {\n\t\t\t\t\t\t'critical': 'px-2 py-1 rounded text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400',\n\t\t\t\t\t\t'warning': 'px-2 py-1 rounded text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400',\n\t\t\t\t\t\t'info': 'px-2 py-1 rounded text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400'\n\t\t\t\t\t};\n\t\t\t\t\treturn classes[severity.toLowerCase()] || '';\n\t\t\t\t},\n\n\t\t\t\tgetSeverityBadgeClass(severity) {\n\t\t\t\t\tconst classes = {\n\t\t\t\t\t\t'critical': 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400',\n\t\t\t\t\t\t'warning': 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400',\n\t\t\t\t\t\t'info': 'bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400'\n\t\t\t\t\t};\n\t\t\t\t\treturn classes[severity.toLowerCase()] || 'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300';\n\t\t\t\t},\n\n\t\t\t\tsortBy(column) {\n\t\t\t\t\tif (this.sortColumn === column) {\n\t\t\t\t\t\t// Toggle direction if same column\n\t\t\t\t\t\tthis.sortDirection = this.sortDirection === 'asc' ? 'desc' : 'asc';\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// New column, default to descending for numeric columns, ascending for text\n\t\t\t\t\t\tthis.sortColumn = column;\n\t\t\t\t\t\tthis.sortDirection = column === 'name' ? 'asc' : 'desc';\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\tgetSortedStatistics() {\n\t\t\t\t\tif (!this.statsData?.statistics) return [];\n\n\t\t\t\t\tconst entries = Object.entries(this.statsData.statistics);\n\n\t\t\t\t\treturn entries.sort((a, b) => {\n\t\t\t\t\t\tconst [keyA, statA] = a;\n\t\t\t\t\t\tconst [keyB, statB] = b;\n\n\t\t\t\t\t\tlet valueA, valueB;\n\n\t\t\t\t\t\tswitch(this.sortColumn) {\n\t\t\t\t\t\t\tcase 'name':\n\t\t\t\t\t\t\t\tvalueA = keyA.toLowerCase();\n\t\t\t\t\t\t\t\tvalueB = keyB.toLowerCase();\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'count':\n\t\t\t\t\t\t\t\tvalueA = statA.count || 0;\n\t\t\t\t\t\t\t\tvalueB = statB.count || 0;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'avg_duration':\n\t\t\t\t\t\t\t\tvalueA = statA.avg_duration_seconds || 0;\n\t\t\t\t\t\t\t\tvalueB = statB.avg_duration_seconds || 0;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'total_duration':\n\t\t\t\t\t\t\t\tvalueA = statA.total_duration_seconds || 0;\n\t\t\t\t\t\t\t\tvalueB = statB.total_duration_seconds || 0;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'avg_mttr':\n\t\t\t\t\t\t\t\tvalueA = statA.avg_mttr_seconds || 0;\n\t\t\t\t\t\t\t\tvalueB = statB.avg_mttr_seconds || 0;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tvalueA = statA.count || 0;\n\t\t\t\t\t\t\t\tvalueB = statB.count || 0;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (valueA < valueB) return this.sortDirection === 'asc' ? -1 : 1;\n\t\t\t\t\t\tif (valueA > valueB) return this.sortDirection === 'asc' ? 1 : -1;\n\t\t\t\t\t\treturn 0;\n\t\t\t\t\t});\n\t\t\t\t},\n\n\t\t\t\tgetSortIcon(column) {\n\t\t\t\t\tif (this.sortColumn !== column) {\n\t\t\t\t\t\treturn '<svg class=\"w-4 h-4 text-gray-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4\"/></svg>';\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.sortDirection === 'asc') {\n\t\t\t\t\t\treturn '<svg class=\"w-4 h-4 text-blue-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M5 15l7-7 7 7\"/></svg>';\n\t\t\t\t\t}\n\n\t\t\t\t\treturn '<svg class=\"w-4 h-4 text-blue-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M19 9l-7 7-7-7\"/></svg>';\n\t\t\t\t},\n\n\t\t\t\tformatNumber(num) {\n\t\t\t\t\treturn new Intl.NumberFormat().format(num || 0);\n\t\t\t\t},\n\n\t\t\t\tformatDuration(seconds) {\n\t\t\t\t\tif (!seconds || seconds === 0) return '0s';\n\n\t\t\t\t\tconst hours = Math.floor(seconds / 3600);\n\t\t\t\t\tconst minutes = Math.floor((seconds % 3600) / 60);\n\t\t\t\t\tconst secs = Math.floor(seconds % 60);\n\n\t\t\t\t\tconst parts = [];\n\t\t\t\t\tif (hours > 0) parts.push(`${hours}h`);\n\t\t\t\t\tif (minutes > 0) parts.push(`${minutes}m`);\n\t\t\t\t\tif (secs > 0 || parts.length === 0) parts.push(`${secs}s`);\n\n\t\t\t\t\treturn parts.join(' ');\n\t\t\t\t},\n\n\t\t\t\tformatMTTR(seconds) {\n\t\t\t\t\tif (!seconds || seconds === 0) return 'N/A';\n\t\t\t\t\treturn this.formatDuration(seconds);\n\t\t\t\t},\n\n\t\t\t\tgetPercentage(count) {\n\t\t\t\t\tif (!this.statsData?.total_alerts || this.statsData.total_alerts === 0) return 0;\n\t\t\t\t\treturn (count / this.statsData.total_alerts * 100).toFixed(1);\n\t\t\t\t},\n\n\t\t\t\tgetMaxCount() {\n\t\t\t\t\tif (!this.statsData?.statistics) return 0;\n\t\t\t\t\tconst counts = Object.values(this.statsData.statistics).map(s => s.count || 0);\n\t\t\t\t\treturn Math.max(...counts, 1);\n\t\t\t\t},\n\n\t\t\t\tformatDate(dateStr) {\n\t\t\t\t\tif (!dateStr) return '';\n\t\t\t\t\tconst date = new Date(dateStr);\n\t\t\t\t\treturn date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });\n\t\t\t\t},\n\n\t\t\t\texportData() {\n\t\t\t\t\tif (!this.statsData) return;\n\n\t\t\t\t\t// Generate CSV\n\t\t\t\t\tlet csv = '';\n\n\t\t\t\t\tif (this.filters.groupBy === 'period') {\n\t\t\t\t\t\t// Export period breakdown\n\t\t\t\t\t\tcsv = 'Period,Start Time,End Time,Total Count,Severities\\n';\n\t\t\t\t\t\tthis.statsData.breakdown.forEach(item => {\n\t\t\t\t\t\t\tconst severities = Object.entries(item.statistics || {})\n\t\t\t\t\t\t\t\t.map(([sev, stat]) => `${sev}:${stat.count}`)\n\t\t\t\t\t\t\t\t.join(';');\n\t\t\t\t\t\t\tcsv += `\"${item.period}\",\"${item.start_time}\",\"${item.end_time}\",${item.total_count},\"${severities}\"\\n`;\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Export grouped statistics\n\t\t\t\t\t\tcsv = 'Category,Count,Avg Duration (s),Total Duration (s),Avg MTTR (s)\\n';\n\t\t\t\t\t\tObject.entries(this.statsData.statistics || {}).forEach(([key, stat]) => {\n\t\t\t\t\t\t\tcsv += `\"${key}\",${stat.count},${stat.avg_duration_seconds},${stat.total_duration_seconds},${stat.avg_mttr_seconds}\\n`;\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\t// Download CSV\n\t\t\t\t\tconst blob = new Blob([csv], { type: 'text/csv' });\n\t\t\t\t\tconst url = window.URL.createObjectURL(blob);\n\t\t\t\t\tconst a = document.createElement('a');\n\t\t\t\t\ta.href = url;\n\t\t\t\t\ta.download = `alert-statistics-${this.filters.startDate}-to-${this.filters.endDate}.csv`;\n\t\t\t\t\tdocument.body.appendChild(a);\n\t\t\t\t\ta.click();\n\t\t\t\t\tdocument.body.removeChild(a);\n\t\t\t\t\twindow.URL.revokeObjectURL(url);\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t</script>")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		return nil
	})
}

var _ = templruntime.GeneratedTemplate
